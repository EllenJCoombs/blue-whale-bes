---
title: "Blue Whale - Figures for Paper"
output: html_notebook
date: "`r Sys.Date()`"
author: Andrew L Jackson
---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>", 
                      fig.width = 8, fig.height = 6)

```

This file, by AJ, is used to generate `ggplot` figures of the data for inclusion in the paper, as per the notes in the `README` file. Currently it creates some simluated data in order to explore how best to render the figures.

```{r import-data}
# load required libraries
# library(SIBER)
library(ggplot2)
library(dplyr)

rm(list=ls())
graphics.off()
set.seed(1)
# read in the data

# simulate some data for now.
t.max <- 60 # number of time steps
increment <- seq(0,t.max)

n.t <- length(increment)

dt <- 1 # the time per increment in days.
time <- increment * dt

# simulate the d13C data
dC <- arima.sim(n = n.t, 
                list(ar = c(0.8897, -0.4858), ma = c(-0.2279, 0.2488)),
                sd = sqrt(0.1796))

# create the dataframe
df <- data.frame(dC = as.numeric(dC), time = time, increment = increment)

# duplicate the dataframe to simulate multiple jittered time series
n.series <- 6
df.list <- vector("list", n.series)
df.list <- lapply(df.list, function(x) {
  x <- df; x$dC <- x$dC + rnorm(nrow(x), 0, 0.2); return(x)
  })

# bind them all into a single data.frame
df.all <- bind_rows(df.list, .id = "id")

```

## Data summary & visualisation
Summarise the data here...

```{r summary-stats}
# some summary stats

# some basic visualisation
plot(dC ~ time, data = df, type = "b")

# same in ggplot
g1 <- ggplot(df.all, aes(time, dC)) + 
  geom_point(aes(color = id)) + 
  geom_line(aes(group = id, color = id)) #+ 
  # geom_bin2d(binwidth = c(1,0.1))
print(g1)


```

## Models

```{r fit-models}
# fit some models

```


## Results
```{r results}
# summarise model results

```




## Some Notebook shortcuts just to remind me

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).
